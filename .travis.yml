language: cpp
compiler:
- gcc
- clang

os:
- linux
- osx
matrix:
  include:
  - os: linux
    env: TRP_DOC=1

before_install:
- if [ "$TRAVIS_OS_NAME" == "linux" ];  then sudo add-apt-repository ppa:team-xbmc/ppa -y; fi
- if [ "$TRAVIS_OS_NAME" == "linux" ];  then sudo add-apt-repository --yes ppa:ubuntu-sdk-team/ppa; fi

- if [ "$TRAVIS_OS_NAME" == "linux" -a "$CXX" = "clang++" ]; then sudo apt-add-repository --yes ppa:ubuntu-toolchain-r/test; fi
- if [ "$TRAVIS_OS_NAME" == "linux" -a "$CXX" = "clang++" ]; then sudo sh -c "echo 'deb http://llvm.org/apt/precise/ llvm-toolchain-precise-3.6 main' >> /etc/apt/sources.list"; fi
- if [ "$TRAVIS_OS_NAME" == "linux" -a "$CXX" = "clang++" ]; then wget -O - http://llvm.org/apt/llvm-snapshot.gpg.key|sudo apt-key add -; fi

- if [ "$TRAVIS_OS_NAME" == "linux" ];  then sudo apt-get update -q; fi


- if [ "$TRAVIS_OS_NAME" == "osx" ]; then brew update; fi

install:

 # clang setup
  
- if [ "$TRAVIS_OS_NAME" == "linux" -a "$CXX" = "clang++" ]; then apt-cache search clang; fi
- if [ "$TRAVIS_OS_NAME" == "linux" -a "$CXX" = "clang++" ]; then sudo apt-get install -y clang-3.6; fi

- if [ "$TRAVIS_OS_NAME" == "linux" ];  then sudo apt-get install libsdl2-dev; fi
- if [ "$TRAVIS_OS_NAME" == "linux" ];  then sudo apt-get install qt5-default; fi

- if [ "$TRAVIS_OS_NAME" == "osx" ]; then brew install sdl2; fi
- if [ "$TRAVIS_OS_NAME" == "osx" ]; then brew install qt5; fi

- if [ $TRP_DOC ]; then sudo apt-get install python-sphinx; fi
before_script:
- mkdir Build
- cd Build
- cmake ..
script:
- if ! [ $TRP_DOC ]; then make; fi
- if [ $TRP_DOC ]; then cd ../Web; make clean;make html;sudo chmod +x ./deploy-ghpages.sh;./deploy-ghpages.sh;cd
  ..; fi
deploy:
  provider: releases
  api_key:
    secure: CTQ9kAUprr9cGiUcRdHvk1h3O6CWGf+f0CI/y6dWQqpRWi0jzdPbZQTvXByz/QpJKJsJF80qlNbxC+hmvU9sEGqgOlnCu1LYxZM8R4/TTuYfu44eIh0qQCrJelXZBOm74PBsYEZ5SAujnvPIRlTQA157PVdseumCYX6BXwnr1xw=
  skip_cleanup: true
  file:
  - Docs/en/out/trp-manual.docx
  - Docs/en/out/trp-manual.html
  on:
    repo: DomDumont/trp
    tags: true
    all_branches: true
env:
  global:
    secure: GpAAZGcxKPf9JB95mA5DBUE6lfbl0giDoSjI2RUMSDP1iJeYq2qTcK5lMxLrIzLP4HmlRzgvKZYYV9Oiuvvicg7ZInhWSiSSaTbpzcfUJuXEeCVGtmjJ/yBHYEuryOfd83KYuWkMT6WaDeuTEGnHa03OuyGXySW0fa7Z0Wtxqus=



